{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center">ðŸ›’ Checkout</h2>

    <!-- Product Details -->
    <div class="card p-4">
        <h4>Product: {{ product.name }}</h4>
        <p>{{ product.description }}</p>
        <h4>Price: â‚¹{{ product.price }}</h4>
    </div>

    <!-- Coupon Dropdown -->
    <form method="post">
        {% csrf_token %}
        <label for="coupon_code" class="form-label mt-3">ðŸŽŸ Apply Coupon:</label>
        <select name="coupon_code" id="coupon_code" class="form-select">
            <option value="">-- Select a Coupon --</option>
            {% for coupon in coupons %}
                <option value="{{ coupon.code }}" {% if applied_coupon == coupon.code %}selected{% endif %}>
                    {{ coupon.code }} - {{ coupon.discount }}% OFF
                </option>
            {% empty %}
                <option disabled>No available coupons</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-success mt-2">Apply Coupon</button>
    </form>

    <!-- Discount Summary -->
    {% if discount_amount %}
        <p class="text-success mt-3">Discount Applied: -â‚¹{{ discount_amount }}</p>
    {% endif %}
    <h4 class="mt-3">Final Amount: â‚¹{{ final_amount }}</h4>

    <!-- Proceed to Payment -->
    <form method="post">
        {% csrf_token %}
        <button type="submit" name="pay_now" class="btn btn-primary mt-3">Proceed to Payment</button>
    </form>
</div>

<!-- Messages -->
{% if messages %}
    <div class="mt-3">
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    </div>
{% endif %}
{% endblock %}
